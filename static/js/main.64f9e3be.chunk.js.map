{"version":3,"sources":["hooks.js","mockAdapter.js","API_URL.js","Tasks/TaskTimer.js","Tasks/ShowTask.js","Tasks/EditTask.js","Tasks/Task.js","Tasks/CreateTaskForm.js","Tasks/CreateTask.js","App/SearchBar.js","App/LocalStorageNotice.js","App/ImportTasks.js","App/ExportTasks.js","App/ButtonBar.js","App.js","index.js"],"names":["isTaskEqualTo","task","otherTask","name","project","useWillUnmount","useState","willUnmount","setWillUnmount","useEffect","useErrorMessage","errorMessage","setErrorMessage","isHidden","setIsHidden","errorDiv","className","timeout","setTimeout","clearTimeout","mockAPI","mockAdapter","MockAdapter","axios","delayResponse","saveTasks","tasks","localStorage","setItem","JSON","stringify","expirationDate","Date","setFullYear","getFullYear","document","cookie","escape","toGMTString","setTasksInCookies","getItem","parse","match","json","unescape","getTasksFromCookies","onGet","reply","config","slice","onPost","newTask","data","some","push","onPatch","old_task","new_task","find","undefined","Object","assign","filter","newTasks","concat","API_URL","Boolean","process","REACT_APP_API","replace","initCanvas","canvas","rect","getBoundingClientRect","width","height","cx","getContext","fillStyle","drawTime","percent","startAngle","Math","PI","endAngle","center","globalAlpha","clearRect","beginPath","moveTo","arc","fill","globalCompositeOperation","TaskTimer","startingSeconds","isTimerRunning","children","canvasRef","useRef","current","JEST_WORKER_ID","timerIsRunning","requestAnimationFrame","frame","time","dt","lastTime","minutePercent","performance","now","startTimer","seconds","drawTimer","ref","zeroPad","number","String","substr","timerReducer","state","action","type","isRunning","millisecondsOnStart","milliseconds","timestampOnStart","millisecondsUntillNextMinute","ShowTask","editTask","updateTasks","selectProject","onPlayStart","useReducer","timer","dispatch","minutes","floor","hours","saveTask","useCallback","callback","patch","then","resp","catch","err","response","status","console","error","stopTimer","map","someTask","window","onbeforeunload","evt","draggable","onDragStart","dataTransfer","setData","onDragOver","preventDefault","onDrop","getData","split","other","otherIndex","findIndex","taskIndex","otherTimestamp","length","timestamp","reorderTasks","style","color","key","onClick","src","alt","title","_fromEvent","setter","target","value","EditTask","cancelEdition","taskName","setTaskName","setMinutes","setHours","hasClickedDelete","setHasClickedDelete","confirmButton","disabled","placeholder","onChange","min","max","post","Task","isEditing","setIsEditing","isFirstTime","setIsFirstTime","tasksLength","newProjectColors","CreateTaskForm","projects","projectColors","onCreate","onCancel","selectedProjectName","setSelectedProjectName","newProjectName","setNewProjectName","random","newProjectColor","setNewProjectColor","taskColor","createButton","onSubmit","event","id","fontStyle","CreateTask","isCreatingTask","setIsCreatingTask","projectsLength","SearchBar","searchQuery","setSearchQuery","inputRef","handleEscape","focus","addEventListener","removeEventListener","right","LocalStorageNotice","isUnderstood","setIsUnderstood","Import","input","createElement","processFile","file","result","accept","click","files","reader","FileReader","readAsText","ExportTasks","a","setAttribute","encodeURIComponent","ButtonBar","ImportTasks","App","setTasks","updateCounter","setUpdateCounter","get","sort","taskA","taskB","searchWords","trim","toLowerCase","every","word","includes","updaterFunction","useTasks","create","reduce","getProjectsFromTasks","clear","href","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.64f9e3be.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport API_URL from \"./API_URL\";\r\n\r\nexport const isTaskEqualTo = task => otherTask =>\r\n  task.name === otherTask.name && task.project === otherTask.project;\r\n\r\nexport function formatTaskName(name) {\r\n  // The slash is needed to separate task name from project.\r\n  return name.replace(/\\//g, \"-\");\r\n}\r\n\r\nexport function useWillUnmount() {\r\n  const [willUnmount, setWillUnmount] = useState(false);\r\n\r\n  useEffect(() => {\r\n    return () => setWillUnmount(true);\r\n  }, []);\r\n\r\n  return willUnmount;\r\n}\r\n\r\nexport function useTasks(searchQuery, setErrorMessage) {\r\n  const willUnmount = useWillUnmount();\r\n  let [tasks, setTasks] = useState(null);\r\n  const [updateCounter, setUpdateCounter] = useState(0);\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get(`${API_URL}/tasks/`)\r\n      .then(resp => {\r\n        if (!willUnmount) {\r\n          setTasks(resp.data);\r\n        }\r\n      })\r\n      .catch(err => {\r\n        if (!willUnmount) {\r\n          if (err.response) {\r\n            setErrorMessage(\"The server responded with an error.\");\r\n          } else {\r\n            setErrorMessage(\r\n              \"Error connecting with the server. Please reload the tab.\"\r\n            );\r\n            console.error(err);\r\n          }\r\n        }\r\n      });\r\n  }, [willUnmount, updateCounter, setErrorMessage]);\r\n\r\n  if (tasks !== null) {\r\n    tasks = tasks.sort((taskA, taskB) => taskB.timestamp - taskA.timestamp);\r\n\r\n    if (searchQuery.length) {\r\n      const searchWords = searchQuery\r\n        .trim()\r\n        .toLowerCase()\r\n        .replace(/\\s+/g, \" \")\r\n        .split(\" \");\r\n\r\n      if (searchWords.length) {\r\n        tasks = tasks.filter(task =>\r\n          searchWords.every(\r\n            word =>\r\n              task.name.toLowerCase().includes(word) ||\r\n              task.project.toLowerCase().includes(word)\r\n          )\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  const updateTasks = updaterFunction => {\r\n    if (updaterFunction) {\r\n      // Manually update, to give immediate feedback\r\n      setTasks(updaterFunction(tasks));\r\n      // (But fetch anyway to validate the API did the right thing.)\r\n    }\r\n    setUpdateCounter(updateCounter + 1);\r\n  };\r\n\r\n  return [tasks, updateTasks];\r\n}\r\n\r\nexport function getProjectsFromTasks(tasks) {\r\n  if (tasks === null) {\r\n    return [];\r\n  }\r\n\r\n  const projectColors = Object.create(null);\r\n\r\n  const projects = tasks.reduce((projects, task) => {\r\n    if (projects.includes(task.project)) {\r\n      return projects;\r\n    }\r\n    projectColors[task.project] = task.color;\r\n\r\n    return [...projects, task.project];\r\n  }, []);\r\n\r\n  return [projects, projectColors];\r\n}\r\n\r\nexport function useErrorMessage() {\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [isHidden, setIsHidden] = useState(true);\r\n\r\n  const errorDiv = (\r\n    <div className={`error-message ${isHidden ? `hidden` : ``}`}>\r\n      {errorMessage}\r\n    </div>\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (errorMessage) {\r\n      setIsHidden(false);\r\n\r\n      let timeout = setTimeout(() => {\r\n        setIsHidden(true);\r\n        setErrorMessage(\"\");\r\n        timeout = null;\r\n      }, 3200);\r\n      return () => {\r\n        if (timeout) {\r\n          clearTimeout(timeout);\r\n        }\r\n      };\r\n    }\r\n  }, [errorMessage]);\r\n\r\n  return [errorDiv, setErrorMessage];\r\n}\r\n","import axios from \"axios\";\r\nimport MockAdapter from \"axios-mock-adapter\";\r\nimport { isTaskEqualTo } from \"./hooks\";\r\n\r\nconst mockAPI = \"https://mock.adapter.com\";\r\nconst mockAdapter = new MockAdapter(axios, { delayResponse: 180 });\r\n\r\nfunction getTasks() {\r\n  if (localStorage.getItem(\"tasks\")) {\r\n    return JSON.parse(localStorage.getItem(\"tasks\"));\r\n  } else {\r\n    // Try to recover data from cookies\r\n    return getTasksFromCookies() || [];\r\n  }\r\n}\r\n\r\nfunction saveTasks(tasks) {\r\n  localStorage.setItem(\"tasks\", JSON.stringify(tasks));\r\n  setTasksInCookies(tasks);\r\n}\r\n\r\nfunction getTasksFromCookies() {\r\n  const cookie = document.cookie;\r\n  const match = cookie.match(/tasks=([^;]+)/);\r\n  const json = match && unescape(match[1]);\r\n  return json && JSON.parse(json);\r\n}\r\n\r\nfunction setTasksInCookies(tasks) {\r\n  const expirationDate = new Date();\r\n  expirationDate.setFullYear(expirationDate.getFullYear() + 6);\r\n  document.cookie = `tasks=${escape(\r\n    JSON.stringify(tasks)\r\n  )};expires=${expirationDate.toGMTString()}`;\r\n}\r\n\r\nlet tasks = getTasks();\r\n\r\nmockAdapter.onGet(`${mockAPI}/tasks/`).reply(config => {\r\n  return [200, tasks.slice()];\r\n});\r\n\r\nmockAdapter.onPost(`${mockAPI}/tasks/`).reply(config => {\r\n  const newTask = JSON.parse(config.data);\r\n\r\n  if (tasks.some(isTaskEqualTo(newTask))) {\r\n    return [403, {}];\r\n  }\r\n\r\n  tasks.push(newTask);\r\n  saveTasks(tasks);\r\n  return [200, {}];\r\n});\r\n\r\nmockAdapter.onPatch(`${mockAPI}/tasks/`).reply(config => {\r\n  const { old_task, new_task } = JSON.parse(config.data);\r\n\r\n  const task = tasks.find(isTaskEqualTo(old_task));\r\n\r\n  if (\r\n    !isTaskEqualTo(old_task)(new_task) &&\r\n    tasks.some(isTaskEqualTo(new_task))\r\n  ) {\r\n    // Trying to change task name, but it already exists a task with the new name.\r\n    return [405, {}];\r\n  }\r\n\r\n  if (task === undefined) {\r\n    return [403, {}];\r\n  }\r\n\r\n  Object.assign(task, new_task);\r\n  saveTasks(tasks);\r\n  return [200, {}];\r\n});\r\n\r\nmockAdapter.onPost(`${mockAPI}/delete-task/`).reply(config => {\r\n  const task = JSON.parse(config.data);\r\n\r\n  if (!tasks.some(isTaskEqualTo(task))) {\r\n    return [403, {}];\r\n  }\r\n\r\n  tasks = tasks.filter(otherTask => !isTaskEqualTo(task)(otherTask));\r\n  saveTasks(tasks);\r\n  return [200, {}];\r\n});\r\n\r\nmockAdapter.onPost(`${mockAPI}/import-tasks/`).reply(config => {\r\n  const newTasks = JSON.parse(config.data);\r\n\r\n  tasks = tasks\r\n    .filter(task => !newTasks.some(isTaskEqualTo(task)))\r\n    .concat(newTasks);\r\n\r\n  saveTasks(tasks);\r\n  return [200, {}];\r\n});\r\n\r\nexport { mockAPI };\r\n","import { mockAPI } from \"./mockAdapter\";\r\n\r\nconst usesRealAPI = Boolean(process.env.REACT_APP_API);\r\nconst API_URL = usesRealAPI\r\n  ? process.env.REACT_APP_API.replace(/\\/^/, \"\")\r\n  : mockAPI;\r\n\r\n// If there's no real API, all requests will be sent to the mockAPI url.\r\n// Then the mockAdapter will take care of them.\r\n\r\nexport default API_URL;\r\n","import React, { useRef, useEffect } from \"react\";\r\n\r\nfunction initCanvas(canvas) {\r\n  const rect = canvas.getBoundingClientRect();\r\n  const width = (canvas.width = rect.width);\r\n  const height = (canvas.height = rect.height);\r\n\r\n  const cx = canvas.getContext(\"2d\");\r\n  cx.fillStyle = \"white\";\r\n\r\n  return [cx, width, height];\r\n}\r\n\r\nfunction drawTime(cx, width, height, percent) {\r\n  const startAngle = -Math.PI / 2;\r\n  const endAngle = Math.PI * 2 * percent + startAngle;\r\n  const center = [width / 2, height / 2];\r\n\r\n  cx.globalAlpha = 0.4;\r\n  cx.clearRect(0, 0, width, height);\r\n  cx.beginPath();\r\n  cx.moveTo(...center);\r\n  cx.arc(...center, width / 2, startAngle, endAngle);\r\n  cx.fill();\r\n\r\n  cx.globalAlpha = 1;\r\n  cx.globalCompositeOperation = \"destination-out\";\r\n  cx.beginPath();\r\n  cx.moveTo(...center);\r\n  cx.arc(...center, width / 2 - 4, 0, Math.PI * 2);\r\n  cx.fill();\r\n  cx.globalCompositeOperation = \"source-over\";\r\n}\r\n\r\nfunction startTimer(canvas, startingSeconds) {\r\n  let timerIsRunning = true;\r\n\r\n  const [cx, width, height] = initCanvas(canvas);\r\n\r\n  requestAnimationFrame(frame);\r\n\r\n  let lastTime = performance.now();\r\n  let minutePercent = (startingSeconds % 60) / 60;\r\n\r\n  function frame(time) {\r\n    if (timerIsRunning) {\r\n      requestAnimationFrame(frame);\r\n    }\r\n\r\n    const dt = (time - lastTime) / 1000;\r\n    lastTime = time;\r\n\r\n    minutePercent += dt / 60;\r\n\r\n    drawTime(cx, width, height, minutePercent);\r\n  }\r\n\r\n  return function stopTimer() {\r\n    timerIsRunning = false;\r\n  };\r\n}\r\n\r\nfunction drawTimer(canvas, seconds) {\r\n  const [cx, width, height] = initCanvas(canvas);\r\n  const percent = (seconds % 60) / 60;\r\n\r\n  drawTime(cx, width, height, percent);\r\n}\r\n\r\nfunction TaskTimer({ startingSeconds, isTimerRunning = false, children }) {\r\n  const canvasRef = useRef(null);\r\n\r\n  // Draw\r\n  useEffect(() => {\r\n    if (canvasRef.current && process.env.JEST_WORKER_ID === undefined) {\r\n      if (isTimerRunning) {\r\n        return startTimer(canvasRef.current, startingSeconds);\r\n      } else {\r\n        drawTimer(canvasRef.current, startingSeconds);\r\n      }\r\n    }\r\n  }, [isTimerRunning, startingSeconds]);\r\n\r\n  return (\r\n    <div className=\"task-timer-container\">\r\n      <canvas ref={canvasRef} className=\"task-timer\"></canvas>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TaskTimer;\r\n","import React, { useEffect, useCallback, useReducer } from \"react\";\r\nimport axios from \"axios\";\r\nimport API_URL from \"../API_URL\";\r\nimport TaskTimer from \"./TaskTimer\";\r\nimport { isTaskEqualTo, useErrorMessage, useWillUnmount } from \"../hooks\";\r\n\r\nconst zeroPad = number => {\r\n  return String(100 + (number % 100)).substr(1);\r\n};\r\n\r\nconst timerReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"START\":\r\n      return {\r\n        ...state,\r\n        isRunning: true,\r\n        millisecondsOnStart: state.milliseconds,\r\n        timestampOnStart: Date.now(),\r\n        millisecondsUntillNextMinute:\r\n          60 * 1000 - (state.milliseconds % (60 * 1000))\r\n      };\r\n    case \"STOP\":\r\n      return {\r\n        ...state,\r\n        isRunning: false\r\n      };\r\n    case \"TICK\":\r\n      const milliseconds =\r\n        state.millisecondsOnStart + Date.now() - state.timestampOnStart;\r\n      return {\r\n        ...state,\r\n        milliseconds,\r\n        millisecondsUntillNextMinute: 60 * 1000 - (milliseconds % (60 * 1000))\r\n      };\r\n    case \"UPDATE\":\r\n      return {\r\n        ...state,\r\n        milliseconds: action.seconds * 1000\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nfunction ShowTask({\r\n  task,\r\n  editTask,\r\n  updateTasks,\r\n  selectProject,\r\n  tasks,\r\n  onPlayStart\r\n}) {\r\n  const [timer, dispatch] = useReducer(timerReducer, {\r\n    isRunning: false,\r\n    milliseconds: task.seconds * 1000,\r\n    millisecondsOnStart: null,\r\n    timestampOnStart: null,\r\n    millisecondsUntillNextMinute: null\r\n  });\r\n\r\n  const minutes = Math.floor(timer.milliseconds / 60 / 1000) % 60;\r\n  const hours = Math.floor(timer.milliseconds / 60 / 1000 / 60);\r\n\r\n  const [errorDiv, setErrorMessage] = useErrorMessage();\r\n  const willUnmount = useWillUnmount();\r\n\r\n  useEffect(() => {\r\n    const seconds = Math.floor(timer.milliseconds / 1000);\r\n\r\n    if (!timer.isRunning && task.seconds !== seconds) {\r\n      dispatch({ type: \"UPDATE\", seconds: task.seconds });\r\n    }\r\n  }, [timer.isRunning, task.seconds, timer.milliseconds]);\r\n\r\n  const saveTask = useCallback(\r\n    callback => {\r\n      const milliseconds =\r\n        timer.millisecondsOnStart + Date.now() - timer.timestampOnStart;\r\n      const seconds = Math.floor(milliseconds / 1000);\r\n\r\n      axios\r\n        .patch(`${API_URL}/tasks/`, {\r\n          old_task: { name: task.name, project: task.project },\r\n          new_task: { ...task, seconds }\r\n        })\r\n        .then(resp => {\r\n          if (callback) {\r\n            callback(seconds);\r\n          }\r\n        })\r\n        .catch(err => {\r\n          if (err.response && err.response.status === 405) {\r\n            setErrorMessage(\r\n              \"Somehow, we tried to change this task name to an invalid one.\"\r\n            );\r\n          } else if (err.response && err.response.status === 403) {\r\n            setErrorMessage(\r\n              \"Invalid request: this task doesn't exist anymore.\"\r\n            );\r\n          } else {\r\n            setErrorMessage(\"Error connecting with the server.\");\r\n            console.error(err);\r\n          }\r\n        });\r\n    },\r\n    [task, timer.millisecondsOnStart, timer.timestampOnStart, setErrorMessage]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (timer.isRunning) {\r\n      const timeout = setTimeout(\r\n        () => dispatch({ type: \"TICK\" }),\r\n        timer.millisecondsUntillNextMinute\r\n      );\r\n      return () => clearTimeout(timeout);\r\n    }\r\n  }, [timer.isRunning, timer.millisecondsUntillNextMinute]);\r\n\r\n  function startTimer() {\r\n    dispatch({ type: \"START\" });\r\n    onPlayStart();\r\n  }\r\n\r\n  // Stop timer and save result\r\n  function stopTimer(callback) {\r\n    saveTask(seconds => {\r\n      updateTasks(tasks =>\r\n        tasks.map(someTask => {\r\n          if (\r\n            someTask.name === task.name &&\r\n            someTask.project === task.project\r\n          ) {\r\n            return { ...task, seconds };\r\n          }\r\n          return someTask;\r\n        })\r\n      );\r\n      if (!willUnmount) {\r\n        dispatch({ type: \"STOP\" });\r\n        if (callback) {\r\n          callback();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // Save task every minute\r\n  useEffect(() => {\r\n    const seconds = Math.floor(timer.milliseconds / 1000);\r\n\r\n    if (timer.isRunning && seconds !== task.seconds && seconds % 60 === 0) {\r\n      saveTask();\r\n    }\r\n  }, [timer.isRunning, saveTask, timer.milliseconds, task.seconds]);\r\n\r\n  function reorderTasks(other) {\r\n    const otherIndex = tasks.findIndex(isTaskEqualTo(other));\r\n    const taskIndex = tasks.findIndex(isTaskEqualTo(task));\r\n\r\n    if (otherIndex === -1 || taskIndex === -1) return;\r\n\r\n    let otherTimestamp;\r\n\r\n    if (otherIndex < taskIndex) {\r\n      otherTimestamp =\r\n        taskIndex >= tasks.length - 1\r\n          ? task.timestamp - 9000\r\n          : tasks[taskIndex + 1].timestamp;\r\n    } else {\r\n      otherTimestamp =\r\n        taskIndex > 0 ? tasks[taskIndex - 1].timestamp : Date.now();\r\n    }\r\n\r\n    const timestamp = Math.floor((task.timestamp + otherTimestamp) / 2);\r\n    const otherTask = tasks.find(isTaskEqualTo(other));\r\n\r\n    axios\r\n      .patch(`${API_URL}/tasks/`, {\r\n        old_task: other,\r\n        new_task: { ...otherTask, timestamp }\r\n      })\r\n      .then(resp => {\r\n        updateTasks();\r\n      })\r\n      .catch(err => {\r\n        if (err.response && err.response.status === 405) {\r\n          setErrorMessage(\r\n            \"Somehow, we tried to change this task name to an invalid one.\"\r\n          );\r\n        } else if (err.response && err.response.status === 403) {\r\n          setErrorMessage(\"Invalid request: This task doesn't exist anymore.\");\r\n        } else {\r\n          setErrorMessage(\"Error connecting with the server.\");\r\n          console.error(err);\r\n        }\r\n      });\r\n  }\r\n\r\n  // Ask confirmation when user closes tab\r\n  useEffect(() => {\r\n    if (timer.isRunning) {\r\n      window.onbeforeunload = evt => {\r\n        return \"There's a task running. You'll loose the timer progress.\";\r\n      };\r\n\r\n      return () => (window.onbeforeunload = undefined);\r\n    }\r\n  }, [timer.isRunning]);\r\n\r\n  return (\r\n    <div\r\n      draggable\r\n      onDragStart={evt => {\r\n        evt.dataTransfer.setData(\"text/plain\", `${task.name}/${task.project}`);\r\n      }}\r\n      onDragOver={evt => evt.preventDefault()}\r\n      onDrop={evt => {\r\n        evt.preventDefault();\r\n        const [name, project] = evt.dataTransfer.getData(\"text\").split(\"/\");\r\n        if (name && project) {\r\n          reorderTasks({ name, project }, task);\r\n        }\r\n      }}\r\n      className=\"task\"\r\n      style={{\r\n        \"--task-color\": task.color\r\n      }}\r\n    >\r\n      <div className=\"task-head\">\r\n        <TaskTimer\r\n          key={minutes}\r\n          startingSeconds={Math.floor(timer.milliseconds / 1000)}\r\n          isTimerRunning={timer.isRunning}\r\n        >\r\n          {!timer.isRunning ? (\r\n            <button className=\"start\" onClick={startTimer}>\r\n              <img\r\n                src={`${process.env.PUBLIC_URL}/baseline_play_arrow_white_24dp.png`}\r\n                alt=\"Start timer\"\r\n                title=\"Start timer\"\r\n              />\r\n            </button>\r\n          ) : (\r\n            <button className=\"stop\" onClick={stopTimer}>\r\n              <img\r\n                src={`${process.env.PUBLIC_URL}/baseline_pause_white_24dp.png`}\r\n                alt=\"Stop timer\"\r\n                title=\"Stop timer\"\r\n              />\r\n            </button>\r\n          )}\r\n        </TaskTimer>\r\n      </div>\r\n      <div className=\"task-body\">\r\n        <div className=\"float-left\">\r\n          <h3>{task.name}</h3>\r\n          {zeroPad(hours)}:{zeroPad(minutes)}\r\n          {\" - \"}\r\n          <span\r\n            className=\"clickable\"\r\n            onClick={() => selectProject(task.project)}\r\n          >\r\n            {task.project}\r\n          </span>\r\n          {errorDiv}\r\n        </div>\r\n        <div className=\"task-foot\">\r\n          <button\r\n            className=\"edit\"\r\n            onClick={() => {\r\n              if (timer.isRunning) {\r\n                stopTimer(editTask);\r\n              } else {\r\n                editTask();\r\n              }\r\n            }}\r\n          >\r\n            Edit\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ShowTask;\r\n","import React, { useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport API_URL from \"../API_URL\";\r\nimport { useWillUnmount, useErrorMessage } from \"../hooks\";\r\nimport TaskTimer from \"./TaskTimer\";\r\n\r\nconst _fromEvent = setter => evt => setter(evt.target.value);\r\n\r\nfunction EditTask({ task, cancelEdition, updateTasks }) {\r\n  const [taskName, setTaskName] = useState(task.name);\r\n  const [minutes, setMinutes] = useState(Math.floor(task.seconds / 60) % 60);\r\n  const [hours, setHours] = useState(Math.floor(task.seconds / 60 / 60));\r\n  const willUnmount = useWillUnmount();\r\n  const [hasClickedDelete, setHasClickedDelete] = useState(false);\r\n  const [errorDiv, setErrorMessage] = useErrorMessage();\r\n\r\n  function editTask() {\r\n    axios\r\n      .patch(`${API_URL}/tasks/`, {\r\n        old_task: { name: task.name, project: task.project },\r\n        new_task: {\r\n          ...task,\r\n          name: taskName,\r\n          seconds: hours * 60 * 60 + minutes * 60\r\n        }\r\n      })\r\n      .then(resp => {\r\n        if (!willUnmount) {\r\n          cancelEdition();\r\n        }\r\n        updateTasks();\r\n      })\r\n      .catch(err => {\r\n        if (err.response && err.response.status === 405) {\r\n          setErrorMessage(\"A task with that name already exists.\");\r\n        } else if (err.response && err.response.status === 403) {\r\n          setErrorMessage(\"Invalid request: this task doesn't exist anymore!\");\r\n        } else {\r\n          setErrorMessage(\"Error connecting with the server.\");\r\n          console.error(err);\r\n        }\r\n      });\r\n  }\r\n\r\n  function deleteTask() {\r\n    axios\r\n      .post(`${API_URL}/delete-task/`, {\r\n        name: task.name,\r\n        project: task.project\r\n      })\r\n      .then(resp => {\r\n        if (!willUnmount) {\r\n          cancelEdition();\r\n        }\r\n        updateTasks(tasks =>\r\n          tasks.filter(\r\n            otherTask =>\r\n              task.name !== otherTask.name || task.project !== otherTask.project\r\n          )\r\n        );\r\n      })\r\n      .catch(err => {\r\n        if (err.response && err.response.status === 403) {\r\n          setErrorMessage(\"Invalid request: the task was already deleted!\");\r\n        } else {\r\n          setErrorMessage(\"Error connecting with the server.\");\r\n          console.error(err);\r\n        }\r\n      });\r\n  }\r\n\r\n  const confirmButton = children => (\r\n    <button className=\"confirm\" onClick={editTask} disabled={!taskName}>\r\n      {children}\r\n    </button>\r\n  );\r\n\r\n  return (\r\n    <div className=\"task\" style={{ \"--task-color\": task.color }}>\r\n      <div className=\"task-head\">\r\n        <TaskTimer seconds={task.seconds}>\r\n          {confirmButton(\r\n            <img\r\n              src={`${process.env.PUBLIC_URL}/baseline_edit_white_24dp.png`}\r\n              alt=\"Edit task\"\r\n              title=\"Edit task\"\r\n            />\r\n          )}\r\n        </TaskTimer>\r\n      </div>\r\n      <div className=\"task-body\">\r\n        <h3>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Task name\"\r\n            value={taskName}\r\n            onChange={_fromEvent(setTaskName)}\r\n          />\r\n        </h3>\r\n        <input\r\n          type=\"number\"\r\n          min={0}\r\n          value={hours}\r\n          onChange={_fromEvent(setHours)}\r\n        />\r\n        :\r\n        <input\r\n          type=\"number\"\r\n          min={0}\r\n          max={60}\r\n          value={minutes}\r\n          onChange={_fromEvent(setMinutes)}\r\n        />\r\n        {errorDiv}\r\n      </div>\r\n      <div className=\"task-foot\">\r\n        {confirmButton(\"Edit task\")}\r\n        <button className=\"cancel\" onClick={cancelEdition}>\r\n          Cancel\r\n        </button>\r\n        <button\r\n          className=\"delete\"\r\n          onClick={() => {\r\n            if (hasClickedDelete) deleteTask();\r\n            else setHasClickedDelete(true);\r\n          }}\r\n        >\r\n          {!hasClickedDelete ? \"Delete\" : \"Delete?\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EditTask;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport ShowTask from \"./ShowTask\";\r\nimport EditTask from \"./EditTask\";\r\n\r\nfunction Task({ task, updateTasks, selectProject, tasks }) {\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [isFirstTime, setIsFirstTime] = useState(\r\n    !Boolean(localStorage.getItem(\"hasShownATask\"))\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!isFirstTime) {\r\n      localStorage.setItem(\"hasShownATask\", \"1\");\r\n    }\r\n  }, [isFirstTime]);\r\n\r\n  const tasksLength = tasks ? tasks.length : null;\r\n\r\n  useEffect(() => {\r\n    if (tasksLength !== null && tasksLength > 1) {\r\n      setIsFirstTime(false);\r\n    }\r\n  }, [tasksLength]);\r\n\r\n  if (isEditing) {\r\n    return (\r\n      <EditTask\r\n        task={task}\r\n        cancelEdition={() => setIsEditing(false)}\r\n        updateTasks={updateTasks}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {isFirstTime ? (\r\n        <div\r\n          className=\"first-time-notice\"\r\n          style={{ \"--task-color\": task.color }}\r\n        >\r\n          Now you can hit play to begin tracking the time you spend on{\" \"}\r\n          <b>{task.name}</b>.\r\n        </div>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n      <ShowTask\r\n        task={task}\r\n        editTask={() => {\r\n          setIsFirstTime(false);\r\n          setIsEditing(true);\r\n        }}\r\n        onPlayStart={() => {\r\n          setIsFirstTime(false);\r\n        }}\r\n        updateTasks={updateTasks}\r\n        selectProject={selectProject}\r\n        tasks={tasks}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Task;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport API_URL from \"../API_URL\";\r\nimport TaskTimer from \"./TaskTimer\";\r\nimport { useErrorMessage } from \"../hooks\";\r\n\r\nconst _fromEvent = setter => evt => setter(evt.target.value);\r\n\r\nconst newProjectColors = [\r\n  \"#6d7502\",\r\n  \"#1fad13\",\r\n  \"#c60d8f\",\r\n  \"#5577ff\",\r\n  \"#ff3344\"\r\n];\r\n\r\nfunction CreateTaskForm({\r\n  projects,\r\n  projectColors,\r\n  onCreate,\r\n  onCancel,\r\n  isFirstTime\r\n}) {\r\n  const [taskName, setTaskName] = useState(\"\");\r\n  const [selectedProjectName, setSelectedProjectName] = useState(\r\n    projects[0] || \"\"\r\n  );\r\n  const [newProjectName, setNewProjectName] = useState(\"\");\r\n  const [newProjectColor, setNewProjectColor] = useState(\r\n    newProjectColors[Math.floor(Math.random() * newProjectColors.length)]\r\n  );\r\n\r\n  const taskColor = selectedProjectName\r\n    ? projectColors[selectedProjectName]\r\n    : newProjectColor;\r\n\r\n  const [errorDiv, setErrorMessage] = useErrorMessage();\r\n\r\n  useEffect(() => {\r\n    if (projects.length === 0) {\r\n      setSelectedProjectName(\"\");\r\n    }\r\n  }, [projects.length]);\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    axios\r\n      .post(`${API_URL}/tasks/`, {\r\n        name: taskName,\r\n        project: selectedProjectName || newProjectName,\r\n        color: taskColor,\r\n        seconds: 0,\r\n        timestamp: Date.now()\r\n      })\r\n      .then(onCreate)\r\n      .catch(err => {\r\n        if (err.response && err.response.status === 403) {\r\n          setErrorMessage(\"The task already exists!\");\r\n        } else {\r\n          setErrorMessage(\"Error connecting with the server.\");\r\n          console.error(err);\r\n        }\r\n      });\r\n  }\r\n\r\n  const createButton = children => (\r\n    <button\r\n      className=\"confirm\"\r\n      disabled={!taskName || !(selectedProjectName || newProjectName)}\r\n    >\r\n      {children}\r\n    </button>\r\n  );\r\n\r\n  return (\r\n    <form\r\n      className=\"task\"\r\n      onSubmit={handleSubmit}\r\n      style={{ \"--task-color\": taskColor }}\r\n    >\r\n      {isFirstTime ? (\r\n        <div className=\"first-time-notice\">\r\n          Start by creating a task. Just anything you're working on.\r\n        </div>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n      <div className=\"task-head\">\r\n        <TaskTimer seconds={0}>\r\n          {createButton(\r\n            <img\r\n              src={`${process.env.PUBLIC_URL}/baseline_add_white_24dp.png`}\r\n              alt=\"Create task\"\r\n              title=\"Create task\"\r\n            />\r\n          )}\r\n        </TaskTimer>\r\n      </div>\r\n      <div className=\"task-body\">\r\n        <h3>\r\n          <input\r\n            type=\"text\"\r\n            id=\"task-name\"\r\n            placeholder=\"Task name\"\r\n            value={taskName}\r\n            onChange={_fromEvent(setTaskName)}\r\n          />\r\n        </h3>\r\n        {projects.length ? (\r\n          <>\r\n            <select\r\n              id=\"project-name\"\r\n              value={selectedProjectName}\r\n              onChange={_fromEvent(setSelectedProjectName)}\r\n            >\r\n              {projects.map(project => (\r\n                <option\r\n                  key={project}\r\n                  value={project}\r\n                  style={{ \"--task-color\": projectColors[project] }}\r\n                >\r\n                  {project}\r\n                </option>\r\n              ))}\r\n              <option\r\n                value=\"\"\r\n                style={{\r\n                  \"--task-color\": newProjectColor,\r\n                  fontStyle: \"italic\"\r\n                }}\r\n              >\r\n                New project\r\n              </option>\r\n            </select>\r\n            <br />\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n        {selectedProjectName === \"\" || !projects.length ? (\r\n          <>\r\n            <input\r\n              type=\"text\"\r\n              id=\"new-project-name\"\r\n              placeholder=\"Project name\"\r\n              value={newProjectName}\r\n              onChange={_fromEvent(setNewProjectName)}\r\n            />\r\n            <input\r\n              type=\"color\"\r\n              id=\"new-project-color\"\r\n              value={newProjectColor}\r\n              onChange={_fromEvent(setNewProjectColor)}\r\n            />\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n        {errorDiv}\r\n      </div>\r\n      <div className=\"task-foot\">\r\n        {createButton(\"Create task\")}\r\n        <button className=\"cancel\" onClick={onCancel}>\r\n          Cancel\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default CreateTaskForm;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport CreateTaskForm from \"./CreateTaskForm\";\r\n\r\nexport default function CreateTask({ projects, projectColors, updateTasks }) {\r\n  const [isFirstTime, setIsFirstTime] = useState(\r\n    !Boolean(localStorage.getItem(\"hasCreatedATask\"))\r\n  );\r\n  const [isCreatingTask, setIsCreatingTask] = useState(isFirstTime);\r\n\r\n  useEffect(() => {\r\n    if (isFirstTime === false) {\r\n      localStorage.setItem(\"hasCreatedATask\", \"1\");\r\n    }\r\n  }, [isFirstTime]);\r\n\r\n  const projectsLength = projects ? projects.length : null;\r\n\r\n  useEffect(() => {\r\n    if (projectsLength === 0) {\r\n      setIsCreatingTask(true);\r\n    } else if (projectsLength !== null && projectsLength > 0) {\r\n      setIsFirstTime(false);\r\n    }\r\n  }, [projectsLength]);\r\n\r\n  if (isCreatingTask && projects) {\r\n    return (\r\n      <CreateTaskForm\r\n        projects={projects}\r\n        projectColors={projectColors}\r\n        onCreate={() => {\r\n          setIsFirstTime(false);\r\n          setIsCreatingTask(false);\r\n          updateTasks();\r\n        }}\r\n        onCancel={() => setIsCreatingTask(false)}\r\n        isFirstTime={isFirstTime}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <button\r\n      className=\"task task-head new-task\"\r\n      onClick={() => setIsCreatingTask(true)}\r\n    >\r\n      New task\r\n    </button>\r\n  );\r\n}\r\n","import React, { useEffect, useRef } from \"react\";\r\n\r\nconst _fromEvent = setter => evt => setter(evt.target.value);\r\n\r\nfunction SearchBar({ searchQuery, setSearchQuery }) {\r\n  const inputRef = useRef(null);\r\n\r\n  // Use Escape key to clear and focus\r\n  useEffect(() => {\r\n    function handleEscape(event) {\r\n      if (event.key === \"Escape\") {\r\n        setSearchQuery(\"\");\r\n        if (inputRef) {\r\n          inputRef.current.focus();\r\n        }\r\n      }\r\n    }\r\n\r\n    window.addEventListener(\"keydown\", handleEscape);\r\n    return () => window.removeEventListener(\"keydown\", handleEscape);\r\n  }, [setSearchQuery]);\r\n\r\n  // Focus input when searchQuery changes\r\n  useEffect(() => {\r\n    if (inputRef) {\r\n      inputRef.current.focus();\r\n    }\r\n  }, [searchQuery]);\r\n\r\n  return (\r\n    <div className=\"search-bar\">\r\n      <img\r\n        src={`${process.env.PUBLIC_URL}/baseline_search_black_18dp.png`}\r\n        alt=\"\"\r\n        onClick={() => {\r\n          if (inputRef.current) {\r\n            inputRef.current.focus();\r\n          }\r\n        }}\r\n      />\r\n      <input\r\n        type=\"text\"\r\n        value={searchQuery}\r\n        onChange={_fromEvent(setSearchQuery)}\r\n        ref={inputRef}\r\n      />\r\n      <img\r\n        src={`${process.env.PUBLIC_URL}/baseline_close_black_18dp.png`}\r\n        alt=\"\"\r\n        style={{ right: \"2px\" }}\r\n        onClick={() => {\r\n          setSearchQuery(\"\");\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SearchBar;\r\n","import React, { useState, useEffect } from \"react\";\r\n\r\nfunction LocalStorageNotice() {\r\n  const [isUnderstood, setIsUnderstood] = useState(\r\n    Boolean(localStorage.getItem(\"understood-local-storage-notice\"))\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (isUnderstood) {\r\n      localStorage.setItem(\"understood-local-storage-notice\", \"1\");\r\n    }\r\n  }, [isUnderstood]);\r\n\r\n  if (process.env.REACT_APP_API !== undefined) {\r\n    // If we use a real API, don't show this notice.\r\n    return <></>;\r\n  }\r\n\r\n  if (isUnderstood) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"local-storage-notice\">\r\n      <div>\r\n        This site uses both <b>cookies</b> and <b>localStorage</b> to store your\r\n        user data (it should be safe unless you decide to clear your cache). Any\r\n        data you provide is saved on your current browser and device <i>only</i>\r\n        . The server doesn't store any data whatsoever, so you're adviced to\r\n        keep regular backups using the Export function.\r\n      </div>\r\n      <button onClick={() => setIsUnderstood(true)}>I understand</button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LocalStorageNotice;\r\n","import React from \"react\";\r\nimport axios from \"axios\";\r\nimport API_URL from \"../API_URL\";\r\n\r\nfunction Import({ updateTasks, setErrorMessage }) {\r\n  function importTasks() {\r\n    const input = document.createElement(\"input\");\r\n    input.type = \"file\";\r\n    input.accept = \".json\";\r\n    input.click();\r\n\r\n    input.addEventListener(\"change\", readFile);\r\n\r\n    function readFile() {\r\n      if (input.files.length) {\r\n        const reader = new FileReader();\r\n        const file = input.files[0];\r\n        reader.readAsText(file);\r\n        reader.addEventListener(\"load\", processFile);\r\n      }\r\n    }\r\n\r\n    function processFile(event) {\r\n      const file = event.target.result;\r\n\r\n      if (!file || !file.length) return;\r\n\r\n      let newTasks;\r\n      try {\r\n        newTasks = JSON.parse(file);\r\n      } catch (error) {\r\n        setErrorMessage(\"The file is invalid or corrupted.\");\r\n        return;\r\n      }\r\n\r\n      axios\r\n        .post(`${API_URL}/import-tasks/`, newTasks)\r\n        .then(result => {\r\n          updateTasks();\r\n        })\r\n        .catch(err => {\r\n          if (err.response) {\r\n            setErrorMessage(\"There was an error importing tasks.\");\r\n          } else {\r\n            setErrorMessage(\"There was an error connecting to the server.\");\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <button className=\"import-tasks\" onClick={importTasks}>\r\n      Import\r\n    </button>\r\n  );\r\n}\r\n\r\nexport default Import;\r\n","import React from \"react\";\r\n\r\nfunction ExportTasks({ tasks }) {\r\n  function exportTasks() {\r\n    const a = document.createElement(\"a\");\r\n    a.setAttribute(\r\n      \"href\",\r\n      \"data:text/plain;charset=utf-u,\" +\r\n        encodeURIComponent(JSON.stringify(tasks))\r\n    );\r\n    a.setAttribute(\"download\", \"Tasks backup.json\");\r\n    a.click();\r\n  }\r\n\r\n  return (\r\n    <button className=\"export-tasks\" onClick={exportTasks}>\r\n      Export\r\n    </button>\r\n  );\r\n}\r\n\r\nexport default ExportTasks;\r\n","import React from \"react\";\r\nimport ImportTasks from \"./ImportTasks\";\r\nimport ExportTasks from \"./ExportTasks\";\r\n\r\nfunction ButtonBar({ tasks, updateTasks, setErrorMessage }) {\r\n  return (\r\n    <div className=\"button-bar task\">\r\n      <ImportTasks\r\n        updateTasks={updateTasks}\r\n        setErrorMessage={setErrorMessage}\r\n      />\r\n      <ExportTasks tasks={tasks} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ButtonBar;\r\n","import React, { useState } from \"react\";\r\nimport Task from \"./Tasks/Task\";\r\nimport CreateTask from \"./Tasks/CreateTask\";\r\nimport { useTasks, getProjectsFromTasks, useErrorMessage } from \"./hooks\";\r\nimport SearchBar from \"./App/SearchBar\";\r\nimport LocalStorageNotice from \"./App/LocalStorageNotice\";\r\nimport ButtonBar from \"./App/ButtonBar\";\r\n\r\nfunction App() {\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [errorDiv, setErrorMessage] = useErrorMessage();\r\n  const [tasks, updateTasks] = useTasks(searchQuery, setErrorMessage);\r\n  const [projects, projectColors] = getProjectsFromTasks(tasks);\r\n\r\n  return (\r\n    <div className=\"task-container\">\r\n      <SearchBar searchQuery={searchQuery} setSearchQuery={setSearchQuery} />\r\n      <ButtonBar\r\n        tasks={tasks}\r\n        updateTasks={updateTasks}\r\n        setErrorMessage={setErrorMessage}\r\n      />\r\n      <CreateTask\r\n        projects={projects}\r\n        projectColors={projectColors}\r\n        updateTasks={updateTasks}\r\n      />\r\n      <div style={{ clear: \"both\" }}></div>\r\n      {errorDiv}\r\n      {tasks !== null\r\n        ? tasks.map(task => (\r\n            <Task\r\n              key={`${task.project}/${task.name}`}\r\n              task={task}\r\n              selectProject={setSearchQuery}\r\n              updateTasks={updateTasks}\r\n              tasks={tasks}\r\n            />\r\n          ))\r\n        : \"\"}\r\n      <div style={{ clear: \"both\" }}></div>\r\n      <div className=\"footer task\">\r\n        <LocalStorageNotice />\r\n        <br />\r\n        Mauro Cano Brusa (c) 2019.{\" \"}\r\n        <a href=\"https://github.com/mauroc8/react-time-tracker\">View source</a>.\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport \"./index.css\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"root\"));\r\n"],"sourceRoot":""}